name: "Publish artifact"
description: "Generic action to publish artifacts"

inputs:
  jf_url:
    required: true
  jf_user:
    required: true
  jf_password:
    required: true
  repository_type:
    required: true

runs:
  using: "composite"
  steps:
    - name: Checkout
      uses: actions/checkout@v3.5.3
    - name: Setup JFrog CLI
      uses: jfrog/setup-jfrog-cli@v3.3.0
      with:
        version: 2.40.0
      env:
        JF_URL: ${{ inputs.jf_url }}        
        JF_USER: ${{ inputs.jf_user }}
        JF_PASSWORD: ${{ inputs.jf_password }}
    - name: Adds a server configuration
      run: |
        jf c add mondo192 --url=$JF_URL --user=$JF_USER --password=$JF_PASSWORD --interactive=false
      shell: bash
    - name: Publish NPM Artifact
      if: ${{ inputs.repository_type == 'npm' }}
      run: |
        jf config add mondo192
        jf npm-config 
        jf npm publish --build-name=bootstrap --build-number=${{ github.ref_name }}
      shell: bash
    - name: Publish GEM Artifact
      if: ${{ inputs.repository_type == 'gem' }}
      run: |
        echo "Hello from GEM"
        jf npm-config 
        jf npm publish --build-name=bootstrap --build-number=${{ github.ref_name }}
      shell: bash

        

